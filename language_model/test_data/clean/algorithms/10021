
We numerically solve the Bloch-Torrey equation by discretizing the differential operators in real space using finite differences. The differential equation is either solved directly in time domain as initial-value problem or in frequency domain as boundary-value problem. Especially the solution in time domain is highly efficient and suitable for arbitrary domains and dimensions. As examples, we calculate the average magnetization and the frequency distribution for capillaries and cells which are idealized as cylinders and spheres, respectively. The solution is compared with the commonly used Gaussian approximation and the strong-collision approximation. While these approximations become exact in limiting cases (small or large diffusion coefficient), they strongly deviate from the numerical solution for intermediate values of the diffusion coefficient.

