
An algorithm to calculate NMR signals of a multi-echo pulse sequence with arbitrary position dependent B0 and B1 fields taking into account relaxation and spin-diffusion is presented. The multi-echo pulse sequence consists of an initial RF pulse ("90 degrees " RF pulse) and a series of L refocusing RF pulses with arbitrary phases and flip-angles. The calculation is exact and takes into account all the magnetization pathways that contribute to the signal on a predefined spatial grid. The theoretical prediction is verified experimentally using a high field NMR microscopy system. The algorithm was implemented in a simulation program in order to optimize the design of an inside-out MR intra-vascular catheter that is used for characterization of vessel wall tissue. Measured data obtained with the catheter are in good agreement with the theoretical prediction of the simulation.

