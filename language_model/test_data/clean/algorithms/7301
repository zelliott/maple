
Localization-based superresolution imaging is dependent on finding the positions of individual fluorophores in a sample by fitting the observed single-molecule intensity pattern to the microscope point spread function (PSF). For three-dimensional imaging, system-specific aberrations of the optical system can lead to inaccurate localizations when the PSF model does not account for these aberrations. Here we describe the use of phase-retrieved pupil functions to generate a more accurate PSF and therefore more accurate 3D localizations. The complex-valued pupil function contains information about the system-specific aberrations and can thus be used to generate the PSF for arbitrary defocus. Further, it can be modified to include depth dependent aberrations. We describe the phase retrieval process, the method for including depth dependent aberrations, and a fast fitting algorithm using graphics processing units. The superior localization accuracy of the pupil function generated PSF is demonstrated with dual focal plane 3D superresolution imaging of biological structures.

