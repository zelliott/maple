
Respiration induces significant movement of tumours in the vicinity of thoracic and abdominal structures. Real-time image-guided radiotherapy (IGRT) aims to adapt radiation delivery to tumour motion during irradiation. One of the main problems for achieving this objective is the presence of time lag between the acquisition of tumour position and the radiation delivery. Such time lag causes significant beam positioning errors and affects the dose coverage. A method to solve this problem is to employ an algorithm that is able to predict future tumour positions from available tumour position measurements. This paper presents a multiple model approach to respiratory-induced tumour motion prediction using the interacting multiple model (IMM) filter. A combination of two models, constant velocity (CV) and constant acceleration (CA), is used to capture respiratory-induced tumour motion. A Kalman filter is designed for each of the local models and the IMM filter is applied to combine the predictions of these Kalman filters for obtaining the predicted tumour position. The IMM filter, likewise the Kalman filter, is a recursive algorithm that is suitable for real-time applications. In addition, this paper proposes a confidence interval (CI) criterion to evaluate the performance of tumour motion prediction algorithms for IGRT. The proposed CI criterion provides a relevant measure for the prediction performance in terms of clinical applications and can be used to specify the margin to accommodate prediction errors. The prediction performance of the IMM filter has been evaluated using 110 traces of 4-minute free-breathing motion collected from 24 lung-cancer patients. The simulation study was carried out for prediction time 0.1-0.6 s with sampling rates 3, 5 and 10 Hz. It was found that the prediction of the IMM filter was consistently better than the prediction of the Kalman filter with the CV or CA model. There was no significant difference of prediction errors for the sampling rates 5 and 10 Hz. For these sampling rates, the errors of the IMM filter for 0.4 s prediction time were less than 2.1 mm in terms of the 95% CI criterion or 1.1 mm in terms of the standard deviation (SD) or root mean squared errors (RMSE) criterion. For the prediction time of 0.6 s the errors were less than 3.6 mm in terms of the 95% CI criterion or 1.8 mm in terms of the SD/RMSE criterion. The prediction error analysis showed that the average percentage of the target lies outside the 95% CI margin was 5.2% and outside the SD/RMSE margin was 24.3%. This indicates the effectiveness of the 95% CI criterion as a margining strategy to accommodate prediction errors.

