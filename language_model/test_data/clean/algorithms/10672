
The judgment of the imaging quality of an optical system can be carried out by examining its through-focus intensity distribution. It has been shown in a previous paper that a scalar-wave analysis of the imaging process according to the extended Nijboer-Zernike theory allows the retrieval of the complex pupil function of the imaging system, including aberrations as well as transmission variations. However, the applicability of the scalar analysis is limited to systems with a numerical aperture (NA) value of the order of 0.60 or less; beyond these values polarization effects become significant. In this scalar retrieval method, the complex pupil function is represented by means of the coefficients of its expansion in a series involving the Zernike polynomials. This representation is highly efficient, in terms of number and magnitude of the required coefficients, and lends itself quite well to matching procedures in the focal region. This distinguishes the method from the retrieval schemes in the literature, which are normally not based on Zernike-type expansions, and rather rely on point-by-point matching procedures. In a previous paper [J. Opt. Soc. Am. A 20, 2281 (2003)] we have incorporated the extended Nijboer-Zernike approach into the Ignatowsky-Richards/Wolf formalism for the vectorial treatment of optical systems with high NA. In the present paper we further develop this approach by defining an appropriate set of functions that describe the energy density distribution in the focal region. Using this more refined analysis, we establish the set of equations that allow the retrieval of aberrations and birefringence from the intensity point-spread function in the focal volume for high-NA systems. It is shown that one needs four analyses of the intensity distribution in the image volume with different states of polarization in the entrance pupil. Only in this way will it be possible to retrieve the "vectorial" pupil function that includes the effects of birefringence induced by the imaging system. A first numerical test example is presented that illustrates the importance of using the vectorial approach and the correct NA value in the aberration retrieval scheme.

