
The estimation and compensation of quasi-static aberrations is mandatory to reach the ultimate performance of high-contrast imaging systems. COFFEE is a focal plane wave-front sensing method that consists in the extension of phase diversity to high-contrast imaging systems. Based on a Bayesian approach, it estimates the quasi-static aberrations from two focal plane images recorded from the scientific camera itself. In this paper, we present COFFEE's extension which allows an estimation of low and high order aberrations with nanometric precision for any coronagraphic device. The performance is evaluated by realistic simulations, performed in the SPHERE instrument framework. We develop a myopic estimation that allows us to take into account an imperfect knowledge on the used diversity phase. Lastly, we evaluate COFFEE's performance in a compensation process, to optimize the contrast on the detector, and show it allows one to reach the 10(-6) contrast required by SPHERE at a few resolution elements from the star. Notably, we present a non-linear energy minimization method which can be used to reach very high contrast levels (better than 10(7) in a SPHERE-like context).

