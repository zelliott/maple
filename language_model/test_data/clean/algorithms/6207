
The S-plus and R statistical packages have implemented a counting process setup to estimate Cox models with time varying effects of the covariates. The data set has to be re-arranged in a repeated measurement setting: the time is divided into small time intervals where a single event occurs and for each time interval, the covariate values and outcome in the interval for each subject still under observation are stacked to a large data set. This is the known (Tstart,Tstop] algorithm implemented in Therneau's Survival library (S-plus), which has been ported into an R package by Thomas Lumley. However, the expansion of a data set leads to a larger set, which can be hard to handle even with fast modern computers. We propose the use of a fast and efficient algorithm, written in R, which works on the original data without the use of an expansion. The computations are done on the original data set, with significant less memory resources used. This improves the computational time by orders of magnitude. The algorithm can also fit reduced rank Cox models with time varying effects. We illustrate the method on a large data set of 2433 breast cancer patients, a smaller study of 358 ovarian cancer patients, and compare the computational times on simulated data of up to 10,000 cases with SAS proc phreg and survival package in R. For larger data sets our algorithm was several times faster, and was able to handle larger data sets then SAS and R.

