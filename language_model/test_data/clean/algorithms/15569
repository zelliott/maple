
To develop a Bloch wave framework for lattice-resolution contrast derived from coherent or incoherent scattering of an electron probe focused onto a crystal, boundary conditions which influence the propagation of an arbitrarily distorted coherent electron probe are addressed. These boundary conditions are particularly relevant for a probe focused within a unit cell, and lead to a general theory which hinges on Bloch wave excitation amplitudes being written as a function of beam position and focus. Whereas antisymmetric Bloch states are not excited for an incident plane wave at an exact zone axis orientation, these states may be strongly excited depending on probe focus and position within the unit cell. Equations for both coherent and incoherent lattice image contrast in scanning transmission electron microscopy are derived for any detector configuration in the Bloch wave framework. An equivalent expression amenable to evaluation via multislice techniques is also described. It is shown explicitly how mixed dynamic form factors for incoherent scattering should be taken into account for annular dark field or backscattered electron detectors, as well as for characteristic losses detected by X-ray emissions or by electron energy loss spectroscopy. A background contribution from "absorbed" electrons is included in the theory. The contribution of cross-talk from neighbouring columns to incoherent contrast is examined within the context of this theoretical framework.

