
The gamma index is a tool for dose distribution comparison. It combines both dose difference (DD) and distance to agreement (DTA) into a single quantity. Though it is an effective measure, making up for the inadequacy of DD or DTA alone, its calculation can be very time-consuming. For a k-D space with N quantization levels in each dimension, the complexity of the exhaustive search is O(N(2k)). In this work, we proposed an efficient method that reduces the complexity from O(N(2k)) to O(N(k)M), where M is the number of discretized dose values and is comparable to N. More precisely, by embedding the reference dose distribution in a (k+1)-D spatial-dose space, we can use fast Euclidean distance transform with linear complexity to obtain a table of gamma indices evaluated over a range of the (k+1)-D spatial-dose space. Then, to obtain gamma indices for the test dose distribution, it requires only table lookup with complexity O(N(k)). Such a table can also be used for other test dose distributions as long as the reference dose distribution is the same. Simulations demonstrated the efficiency of our proposed method. The speedup for 3D gamma index calculation is expected to be on the order of tens of thousands (from O(N(6)) to O(N(3)M)) if N is a few hundreds, which makes clinical usage of the 3D gamma index feasible. A byproduct of the gamma index table is that the gradient of the gamma index with respect to either the spatial or dose dimension can be easily derived. The gradient can be used to identify the main causes of the discrepancy from the reference distribution at any dose point in the test distribution or incorporated in treatment planning and machine parameter optimization.

