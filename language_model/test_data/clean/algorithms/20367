
An algorithm is described which utilizes the solvent mask generated by the solvent-flattening technique to calculate a monomer molecular envelope. In the case where non-crystallographic symmetry (NCS) is present in the crystal and self-rotation angles are known from a self-rotation function, the resultant monomer envelopes can be used to search for the translation component of the NCS element by a three-dimensional search in real space. In the absence of self-rotation angles, the monomer envelope may be used to derive the NCS operators by reciprocal-space techniques. Thus, an automatic procedure for averaging directly from the solvent-flattening stage can be implemented. The procedure was instrumental in the structure solution of fibrinogen fragment D, which is presented as an example.

