
Electroencephalograms (EEGs) recorded simultaneously with functional magnetic resonance imaging (fMRI) are corrupted by large repetitive artifacts generated by the switched MR gradients. Several methods have been proposed to remove these distortions by subtraction of averaged artifact templates from the ongoing EEG. Here, we present a modification of this approach which accounts for head movements to improve the extracted template. Using the fMRI analysis package statistical parametric mapping (SPM; FIL London) the head displacement is determined at each half fMRI-volume. The basic idea is to apply a moving average algorithm for template extraction but to include only epochs that were obtained at the same head position as the artefact to be removed. This approach was derived from phantom EEG measurements demonstrating substantial variations of the artefact waveform in response to movements of the phantom in the MRI magnet. To further reduce the residual noise, we applied a resampling algorithm which aligns the EEG samples in a strict adaptive manner to the fMRI timing. Finally, we propose a new algorithm to suppress residual artifacts such as those occasionally observed in case of brief strong movements, which are not reflected by the movement indicator because of the limited temporal resolution of the fMRI sequence. On the basis of EEG recordings of six subjects these measures combined reduce the residual artefact activity quantified in terms of the spectral power at the gradient repetition rate and its harmonics by roughly 20 to 50% (depending on the amount of movement) predominantly in frequencies beyond 30 Hz.

