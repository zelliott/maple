
The computation of reduced unit cells is an important building block for a number of crystallographic applications, but unfortunately it is very easy to demonstrate that the conventional implementation of cell reduction algorithms is not numerically stable. A numerically stable implementation of the Niggli-reduction algorithm of Kriv√Ω & Gruber [Acta Cryst. (1976), A32, 297-298] is presented. The stability is achieved by consistently using a tolerance in all floating-point comparisons. The tolerance must be greater than the accumulated rounding errors. A second stable algorithm is also presented, the minimum reduction, that does not require using a tolerance. It produces a cell with minimum lengths and all angles acute or obtuse. The algorithm is a simplified and modified version of the Buerger-reduction algorithm of Gruber [Acta Cryst. (1973), A29, 433-440]. Both algorithms have been enhanced to generate a change-of-basis matrix along with the parameters of the reduced cell.

