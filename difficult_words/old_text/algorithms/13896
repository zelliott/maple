
Modern three-dimensional (3-D) photon dose calculation algorithms need to be fast and accurate if they are to be practical for treatment optimization. Refinements to a previously proposed finite-size pencil beam (FSPB) method are presented in order to fulfill these needs. Specifically, a fast Fourier transform (FFT) convolution technique is used to speed calculation of the FSPB; the fluence spectrum is modeled, and the effects of finite source size, a Gaussian x-ray source intensity profile and partial transmission through a multileaf collimator (MLC) leaf are approximated. The use of FFT techniques in the calculation of small diverging fields involves approximations that are investigated for a 6 MV beam and shown to introduce errors that vary with energy but do not exceed 0.7% on the central axis. Dose distributions calculated by FSPB superposition are in excellent agreement with those calculated by full field FFT convolution. Two key advances over the original implementation of the FSPB model are demonstrated: the fast calculation of the FSPB facilitates development, and the incorporation of realistic beam parameters enables accurate modeling of clinical beams.

