
We develop a joint model for the analysis of longitudinal and survival data in the presence of data clustering. We use a mixed effects model for the repeated measures that incorporates both subject- and cluster-level random effects, with subjects nested within clusters. A Cox frailty model is used for the survival model in order to accommodate the clustering. We then link the two responses via the common cluster-level random effects, or frailties. This model allows us to simultaneously evaluate the effect of covariates on the two types of responses, while accounting for both the relationship between the responses and data clustering. The model was motivated by a study of end-stage renal disease patients undergoing hemodialysis, where we wished to evaluate the effect of iron treatment on both the patients' hemoglobin levels and survival times, with the patients clustered by enrollment site.

