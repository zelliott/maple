
In the previous paper, boundary conditions matching the probe to the crystal wave function in scanning transmission electron microscopy were applied by matching the whole wave function across the boundary. It is shown here how that approach relates to previous Bloch wave formulations using (phase-linked) plane wave boundary conditions for wave vectors implied by the range of transverse momentum components in the incident probe. Matching the whole wave function across the boundary, and including a suitably fine mesh in the reciprocal space associated with the crystal to allow matching of transverse momentum components within the probe, leads to a structure matrix A containing many elements which would normally be excluded for plane wave incidence. For perfect crystals, the A-matrix may be block diagonalised. This leads to a considerable increase in the computational efficiency of the model and yields important insights into the physics of convergent probes in perfect crystals-reciprocity in coherent imaging and the small aperture limit for coherent and incoherent contrast are considered. The numerical equivalence of the incoherent lattice contrast calculated in this Bloch wave method and the multislice method using mixed dynamic form factors will be demonstrated. Comparison between both these methods and the frozen phonon model, a prevalent multislice method for annular dark field simulation which has the theoretical advantage of handling double channelling, will be made.

