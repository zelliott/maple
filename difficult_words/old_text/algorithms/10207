
An algorithm capable of mitigating respiratory motion blurring artifacts in cone-beam computed tomography (CBCT) lung tumor images based on the motion of the tumor during the CBCT scan is developed. The tumor motion trajectory and probability density function (PDF) are reconstructed from the acquired CBCT projection images using a recently developed algorithm Lewis et al (2010 Phys. Med. Biol. 55 2505-22). Assuming that the effects of motion blurring can be represented by convolution of the static lung (or tumor) anatomy with the motion PDF, a cost function is defined, consisting of a data fidelity term and a total variation regularization term. Deconvolution is performed through iterative minimization of this cost function. The algorithm was tested on digital respiratory phantom, physical respiratory phantom and patient data. A clear qualitative improvement is evident in the deblurred images as compared to the motion-blurred images for all cases. Line profiles show that the tumor boundaries are more accurately and clearly represented in the deblurred images. The normalized root-mean-squared error between the images used as ground truth and the motion-blurred images are 0.29, 0.12 and 0.30 in the digital phantom, physical phantom and patient data, respectively. Deblurring reduces the corresponding values to 0.13, 0.07 and 0.19. Application of a -700 HU threshold to the digital phantom results in tumor dimension measurements along the superior-inferior axis of 2.8, 1.8 and 1.9 cm in the motion-blurred, ground truth and deblurred images, respectively. Corresponding values for the physical phantom are 3.4, 2.7 and 2.7 cm. A threshold of -500 HU applied to the patient case gives measurements of 3.1, 1.6 and 1.7 cm along the SI axis in the CBCT, 4DCT and deblurred images, respectively. This technique could provide more accurate information about a lung tumor's size and shape on the day of treatment.

