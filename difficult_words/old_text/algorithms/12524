
Non-crystallographic symmetry (NCS) averaging is a well known method for improving the quality of an electron-density map and thus aiding structure determination. Prior methods of NCS-operator determination based on estimated heavy-atom positions are prone to errors arising from inaccuracies in these coordinates or differences in the relative orientations of domains between molecules. In this paper, two real-space methods to determine NCS relationships from initial electron-density maps are presented. A brute-force method identifies matching regions in a map by local density correlation. A feature-based algorithm uses rotation-invariant features to reduce the computational time taken by the brute-force algorithm by filtering out regions that are likely to have dissimilar density patterns. This makes the feature-based algorithm faster and as accurate as the brute-force approach. Neither method requires the positions of heavy atoms or any information regarding the protein sequence. Both methods have been tested on a diverse range of experimentally phased maps and the correct NCS relationships were accurately identified for almost all of the test cases. The NCS operators obtained by the feature-based algorithm were used to perform NCS averaging and an improvement in map correlation was observed for some cases.

