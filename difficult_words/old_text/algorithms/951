
The success in utilizing in vivo NMR to identify and/or monitor metabolic abnormalities will be determined in large part on the reliability with which the spectral parameters of the metabolites present can be measured. For these reasons it is clear that there is a need for the development of algorithms with which to obtain quantitatively reliable estimates of the spectral parameters of the peaks present. In this report we describe an adaptation of the simplex algorithm which we have found useful in fitting in vivo spectral data in the frequency domain. This simplex algorithm was implemented on an IBM-PC AT compatible computer. We evaluated the simplex algorithm on three representative kinds of spectral data: a simulated spectrum, 31P spectrum of normal calf muscle, and the 31P spectrum of a pediatric patient with a brain tumor. In each case we generated a set of spectra by adding varying amounts of noise. On the basis of our simulations and the two examples discussed, we conclude that the simplex method generates parameters which are reliable estimates of the areas of the peaks present when the signal-to-noise is above 8:1 for phosphocreatine. We found that the speed of convergence of the algorithm was improved by overestimating the linewidths of the peaks present. We also found that the method converged more rapidly in the presence of a moderate amount of noise. We conclude that the algorithm described here can provide a robust method with which to analyze in vivo spectra in a quantitative manner. Because the method requires little user intervention, it lends itself to implementation in a semi-, or fully, automated fashion.

