
Accurate liver segmentation on computed tomography (CT) images is a challenging task especially at sites where surrounding tissues (e.g., stomach, kidney) have densities similar to that of the liver and lesions reside at the liver edges. We have developed a method for semiautomatic delineation of the liver contours on contrast-enhanced CT images. The method utilizes a snake algorithm with a gradient vector flow (GVF) field as its external force. To improve the performance of the GVF snake in the segmentation of the liver contour, an edge map was obtained with a Canny edge detector, followed by modifications using a liver template and a concavity removal algorithm. With the modified edge map, for which unwanted edges inside the liver were eliminated, the GVF field was computed and an initial liver contour was formed. The snake algorithm was then applied to obtain the actual liver contour. This algorithm was extended to segment the liver volume in a slice-by-slice fashion, where the result of the preceding slice constrained the segmentation of the adjacent slice. 551 two-dimensional liver images from 20 volumetric images with colorectal metastases spreading throughout the livers were delineated using this method, and also manually by a radiologist for evaluation. The difference ratio, which is defined as the percentage ratio of mismatching volume between the computer and the radiologist's results, ranged from 2.9% to 7.6% with a median value of 5.3%.

