
Rapid movements of live tissues during the acquisition of 3D image stacks can result in misalignments between successive image slices. The remodeling of the muscles in Drosophila metamorphosis is an example where sporadic motion during image acquisition impede image analysis and volume visualization. Most of the image stack registration algorithms applied in microscopy are aimed at the linear alignment of fixed histological sections. However, live muscles are nonrigid objects and their contractions and relaxations represent nonlinear transformations that cannot be properly rectified by applying purely linear registration methods. We developed a fully automated area-based nonrigid stack registration (NSR) method that minimizes the mean square error of intensities between successive image slices. The mapping function is formulated using the thin plate spline (TPS). A hierarchical linear to nonlinear, coarse to fine matching strategy is applied to ensure stability and fast convergence. Topological structure is preserved by constraining the step size of the nonlinear transformation. To assess the accuracy of 3D reconstruction, we propose a new benchmarking method that measures geometrical features of restored nuclei. We tested our algorithm on image stacks generated by laser scanning confocal microscopy that show live muscles during the prepupal stage of Drosophila metamorphosis. Our registration algorithm is able to restore image stacks that are distorted by periodic contraction of muscles. Quantitative assessment of registration performance agrees well with qualitative visual inspection. Our NSR method is able to restore image stacks for the purpose of visualization and quantitative analysis of Drosophila metamorphosis and, potentially, various other processes in developmental biology studied by 3D live cell microscopy.

